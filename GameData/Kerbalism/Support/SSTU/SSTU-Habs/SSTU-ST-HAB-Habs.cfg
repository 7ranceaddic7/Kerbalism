//Removing SSTUVolumeContainer to allow kerbalism to calculate volume/surface

@PART[SSTU-ST-HAB-*]:NEEDS[Kerbalism,SSTU]
{	
	@CrewCapacity = #$MODULE[SSTUInflatable]/inflatedCrew$
	!MODULE[SSTUVolumeContainer] {}	
	!MODULE[ModuleScienceContainer] {}
}

//removing the RCS fuel selection, as the parts lost the ability to swap contents of the containers.

@PART[SSTU-ST-HAB-C1,SSTU-ST-HAB-C2,SSTU-ST-HAB-B1,SSTU-ST-HAB-B2]:NEEDS[Kerbalism,SSTU]
{
	!MODULE[SSTUFuelSelection] {}
	
	@MODULE[ModuleDataTransmitter]:NEEDS[!RemoteTech]
		{
		@packetResourceCost /= 500		//Kerbalism messes with antenna ec consumption. matching.
		}
}

//allowing kerbalism to handle the inflate/deflate state, removing SSTU's one.

@PART[SSTU-ST-HAB-*]:NEEDS[FeatureComfort,SSTU]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{
		%inflate = #$../MODULE[SSTUInflatable]/ANIMATIONDATA/ANIMATION/name$
		%state = disabled
		%animBackwards = False
	}

	!MODULE[SSTUInflatable] {}
}

//adding back the resources lost by removing SSTUVolumeContainer. 
//volumes taken from https://forum.kerbalspaceprogram.com/index.php?/topic/117090-wip16x-sstulabs-low-part-count-solutions-orbiters-landers-lifters-dev-thread-11-18-18/&page=206&tab=comments#comment-2840968

@PART[SSTU-ST-HAB-A1]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 12.27						
		%surface = 8.95
	}
		
	RESOURCE
		{
			name = ElectricCharge
			amount = 300
			@amount /= 2.8
			maxAmount = 300
			@maxAmount /= 2.8
		}
}

@PART[SSTU-ST-HAB-A2]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 18.41						
		%surface = 11.94
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 600
			@amount /= 2.8
			maxAmount = 600
			@maxAmount /= 2.8
		}
}

@PART[SSTU-ST-HAB-B1]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 98.17						
		%surface = 37.96
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 2500
			@amount /= 2.8
			maxAmount = 2500
			@maxAmount /= 2.8
		}

	RESOURCE
		{
			name = Aerozine50
			amount = 216
			maxAmount = 216
		}

	RESOURCE
		{
			name = NTO
			amount = 216
			maxAmount = 216
		}	
}

@PART[SSTU-ST-HAB-B2]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 147.26					
		%surface = 49.90
	}
	RESOURCE
		{
			name = ElectricCharge
			amount = 3248
			@amount /= 2.8
			maxAmount = 3248
			@maxAmount /= 2.8
		}

	RESOURCE
		{
			name = Aerozine50
			amount = 311.5
			maxAmount = 311.5
		}

	RESOURCE
		{
			name = NTO
			amount = 311.5
			maxAmount = 311.5
		}	
}

@PART[SSTU-ST-HAB-B3]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 98.17						
		%surface = 37.96
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 600
			@amount /= 2.8
			maxAmount = 600
			@maxAmount /= 2.8
		}
}

@PART[SSTU-ST-HAB-B4]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 147.26					
		%surface = 49.90
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 1200
			@amount /= 2.8
			maxAmount = 1200
			@maxAmount /= 2.8
		}
}

@PART[SSTU-ST-HAB-C1]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 331.34					
		%surface = 107.43
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 3248
			@amount /= 2.8
			maxAmount = 3248
			@maxAmount /= 2.8
		}

	RESOURCE
		{
			name = Aerozine50
			amount = 481
			maxAmount = 481
		}

	RESOURCE
		{
			name = NTO
			amount = 481
			maxAmount = 481
		}	
}

@PART[SSTU-ST-HAB-C2]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 497.009					
		%surface = 134.29
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 5000
			@amount /= 2.8
			maxAmount = 5000
			@maxAmount /= 2.8
		}

	RESOURCE
		{
			name = Aerozine50
			amount = 693.5
			maxAmount = 693.5
		}

	RESOURCE
		{
			name = NTO
			amount = 693.5
			maxAmount = 481
		}	
}

@PART[SSTU-ST-HAB-C3]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 331.34					
		%surface = 107.43
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 1200
			@amount /= 2.8
			maxAmount = 1200
			@maxAmount /= 2.8
		}
}

@PART[SSTU-ST-HAB-C4]:NEEDS[SSTU,FeatureComfort]:AFTER[Kerbalism]
{
	@MODULE[Habitat]
	{	
		%volume = 497.009					
		%surface = 134.29
	}
	
	RESOURCE
		{
			name = ElectricCharge
			amount = 2400						//default config is 300 EC, which is out of sync with the others
			@amount /= 2.8						//assuming this was an oversight, correcting.
			maxAmount = 2400
			@maxAmount /= 2.8
		}
}
