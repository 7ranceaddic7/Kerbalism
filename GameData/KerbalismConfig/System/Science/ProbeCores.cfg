//==============================================================================
// Add experiments to probe cores
//==============================================================================

@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[0]]]:FOR[Kerbalism]:NEEDS[KerbalismScience]
{
  MODULE
  {
    name = ModuleKsmExperiment
  }

  MODULE
  {
    name = ModuleB9PartSwitch
    switcherDescription = #autoLoc_6003059 // Science Experiment
    moduleID = probeCoreExperiment
    affectDragCubes = false
    affectFARVoxels = false

    SUBTYPE
		{
			name = empty
			title = #kerbalism-part-empty
      switcherDescription = #KERBALISM_None_desc
      primaryColor = KSPNeutralUIGrey

      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmExperiment
        }
        DATA {
          experiment_id =
        }
      }
		}

    SUBTYPE
		{
			name = kerbalism_TELEMETRY
			title = #kerbalism-experiment-telemetry-title
      switcherDescription = #kerbalism-experiment-telemetry-desc
      primaryColor = CoolBlue
      addedCost = 100
      addedMass = 0.001

      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmExperiment
        }
        DATA {
          experiment_id = #$../../name$
          experiment_desc = #kerbalism-experiment-telemetry-title
          data_rate = #$@KERBALISM_SCIENCE_VALUES/TelemetryReport/size$
          @data_rate /= #$@KERBALISM_SCIENCE_VALUES/TelemetryReport/duration$
          ec_rate = #$@KERBALISM_SCIENCE_VALUES/TelemetryReport/ECCost$
        }
      }
		}

    SUBTYPE
		{
			name = kerbalism_LITE
			title = #kerbalism-experiment-lite-title
			descriptionSummary = #kerbalism-experiment-lite-desc
      primaryColor = Cream
      addedCost = 150
      addedMass = 0.004

      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmExperiment
        }
        DATA {
          experiment_id = #$../../name$
          experiment_desc = #$../../descriptionSummary$
          data_rate = #$@KERBALISM_SCIENCE_VALUES/Lite/size$
          @data_rate /= #$@KERBALISM_SCIENCE_VALUES/Lite/duration$
          ec_rate = #$@KERBALISM_SCIENCE_VALUES/Lite/ECCost$
        }
      }
		}

    SUBTYPE
    {
      name = kerbalism_MITE
      title = #kerbalism-experiment-mite-title
      descriptionSummary = #kerbalism-experiment-mite-desc
      primaryColor = DarkMint
      addedCost = 575
      addedMass = 0.025

      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmExperiment
        }
        DATA {
          experiment_id = #$../../name$
          experiment_desc = #$../../descriptionSummary$
          data_rate = #$@KERBALISM_SCIENCE_VALUES/Mite/size$
          @data_rate /= #$@KERBALISM_SCIENCE_VALUES/Mite/duration$
          ec_rate = #$@KERBALISM_SCIENCE_VALUES/Mite/ECCost$
          requires = #$@KERBALISM_SCIENCE_VALUES/Mite/requirements$
        }
      }
    }

    SUBTYPE
    {
      name = kerbalism_SITE
      title = #kerbalism-experiment-site-title
      descriptionSummary = #kerbalism-experiment-site-desc
      primaryColor = BabyShitGreen
      addedCost = 1300
      addedMass = 0.68

      MODULE
      {
        IDENTIFIER {
          name = ModuleKsmExperiment
        }
        DATA {
          experiment_id = #$../../name$
          experiment_desc = #$../../descriptionSummary$
          data_rate = #$@KERBALISM_SCIENCE_VALUES/Site/size$
          @data_rate /= #$@KERBALISM_SCIENCE_VALUES/Site/duration$
          ec_rate = #$@KERBALISM_SCIENCE_VALUES/Site/ECCost$
        }
      }
    }
  }
}
